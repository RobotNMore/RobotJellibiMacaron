# "Base"



### Servo 모터

서보모터란 외부에서 입력되는 신호대로 움직일 수 있는 제어기를 포함한 모터로 간단히 설명할 수 있습니다.  

젤리비보드에는 서보모터를 연결할 수 있는 두 개의 포트(`Servo 01`, `Servo 02`)  가 있습니다.  
각 포트는 전원과 접지(Ground) 그리고 신호선 의 세가닥으로 이루어져 있습니다.  
이 두개의 포트에 Servo 모터를 연결하여 약속된 신호를 주어 Gripper(그리퍼)로 동작하게 되는데 이 떄 사용하는 약속된 신호는 아래와 같은 PWM(Pulse Width Modulation)입니다. 

![Servo Pulse Shape](http://www.robotnmore.com/matthew/servo/servo_pulse.png)

50Hz 진동수 신호에 HIGH(1) 인 구간을 1ms ~ 2ms 범위로 제어하면 서보모터는 0도 에서 180도 사이로 움직이게 됩니다. 즉 듀티비(duty ratio) 5%~10% 사이로 제어하여 서보모터의 움직임을 제어합니다.  

서보포트의 신호선과 젤리비 포트의 핀맵은 아래 표와 같습니다. 

| 젤리비보드 핀(포트) |   Servo    | 젤리비로봇 Gripper 동작 |
| :-----------------: | :--------: | :---------------------: |
|         D9          | `Servo 01` |  그리퍼의 집게를 구동   |
|         D2          | `Servo 02` |  집게의 높낮이를 구동   |



### Source Code

서보모터의 신호선으로 약속된 신호(50Hz 진동수와 듀티비 5%~10% 인 신호) 를 만들기에는 해야 할 일이 너무 많습니다. 그래서 아두이노에서는 이런 신호를 편리하게 만들어 낼 수 있는 라이브러리를 제공하고 있습니다. 

#### 아두이노 Servo 라이브러리 불러오기 

아두이노 툴에서 Servo 라이브러리는 기본적으로 제공되고 있습니다. 
메뉴에서 **`스케치 > 라이브러리 포함하기 > Servo`** 를 선택하면 소스코드 제일 위에 서보라이브러리를 사용할 수 있는 헤더 파일을 포함(include) 하게 되고 서보를 제어할 수 있게 됩니다.

``` c++
#include <Servo.h>
```



#### 아두이노 Servo 라이브러리 사용하기

아두이노의 라이브러리는 `C++` 클래스로 구현합니다. Servo 라이브러리 역시 `C++` 클래스로 구현되었으며 인스턴스를 만들고 멤버 메소드(함수) 를 호출할 수 있습니다.   
Servo 클래스의 멤버로 `attach()` 메서드와 `write()` 메서드를 사용하여 서보모터를 제어합니다.   
`attach()` 메서드는 인자로 젤리비보드의 서보모터 신호선과 연결된 핀번호를 적어 줍니다.   
`write()` 메서드에는 각도를 인자로 해서 지정된 각도만큼 서보가 동작하게 됩니다.   

```c++
#include <Servo.h>

Servo _servo;	// 서보 클래스 인스턴스 생성 
void setup() {
    _servo.attach(9); // 인스턴스 메서드(함수) attach 를 호출하여 9번 핀에 신호를 쓸 준비
}
void loop() {
	_servo.write(45); // 인스턴스 메서드(함수) write 를 호출하여 45도 각도로 제어
}
```



### _Base.ino_ 실행 

1. 아두이노가 설치 된 PC 와 젤리비보드를 USB 커넥터로 연결하고 전원스위치를 켭니다.  
   이 때 젤리비보드의 `PWR` LED 가 녹색으로 켜집니다. 
2. PC 에서 아두이노 툴을 실행하고 연결정보(보드, 포트, 프로세서) 를 설정합니다.
3. **Base.ino** 파일을 아두이노 툴에서 열고 `컴파일(Ctrl+R)` 하고 `업로드(Ctrl+U)` 합니다.
4. 젤리비 보드에 연결된 서보가 동작하는 것을 확인합니다. 