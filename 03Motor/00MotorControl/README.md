# "MotorControl"



### DC 모터제어

로봇젤리비는 두개의 DC 모터로 주행을 할 수 있습니다. 각 DC 모터는 회전속도를 결정하는 PWM(Pulse Width Modulation) 신호와 회전방향을 결정하는 GPIO 신호로  제어할 수 있습니다.   
 (실제로는 젤리비보드에서 출력되는 PWM 신호와 GPIO 신호는 모터를 직접 구동하는 모터드라이버 IC 로 연결되어 있습니다.  모터드라이버 IC 는 젤리비보드에서 만든 PWM 신호의 듀티비(Duty ratio)를 해석하여 모터의 회전속도를 제어합니다.) 

두개의 DC 모터를 제어하기 위해 사용하는 젤리비의 핀(포트)은 아래 표와 같습니다. 

| 젤리비 포트 |               기능               |
| :---------: | :------------------------------: |
|     D6      |  오른쪽 모터 회전속도 제어(PWM)  |
|     D8      | 오른쪽 모터 회전방향 제어 (GPIO) |
|     D5      |   왼쪽 모터 회전속도 제어(PWM)   |
|     D7      |  왼쪽 모터 회전방향 제어(GPIO)   |



### Source Code

회전속도를 결정하는 PWM 신호는 아두이노의 `analogWrite()` 함수로 출력할 수 있으며 회전방향을 결정하는 GPIO 신호는 아두이노의 `digitalWrite()` 함수로 제어할 수 있습니다.  

``` cpp
// analogWrite 함수를 이용하여 PWM 신호를 만들어 냅니다. 
// 인자로 핀번호와 듀티를 전달 합니다. 
// 듀티는 0 ~ 255 사이의 값을 사용하며 255 일 때 듀티비는 100% 이고 0일 때 듀티비는 0%입니다.
digitalWrite(8, LOW);  // 8번핀(오른쪽 모터)을 LOW(0) 로 제어해 전진방향으로 회전시킵니다. 
digitalWrite(7, HIGH); // 7번핀(왼쪽 모터)을 HIGH(1)로 제어해 전진방향으로 회전시킵니다.
analogWrite(6, 255);   // 6번핀(오른쪽 모터)에서 듀티를 100% 인 PWM 신호를 만듭니다.
analogWrite(5, 127) ;  // 5번핀(왼쪽 모터)에서 듀티 50% 인 PWM 신호를 만듭니다.
// 이 네줄의 코드가 실행되면 좌/우 모터의 회전차이로 인하여 로봇젤리비는 좌회전을 하게 됩니다. 
```



### _MotorControl.ino_ 실행

1. 아두이노가 설치 된 PC 와 젤리비보드를 USB 커넥터로 연결하고 전원스위치를 켭니다.   
   이 때 젤리비보드의 `PWR` LED 가 녹색으로 켜집니다. 
2. PC 에서 아두이노 툴을 실행하고 연결정보(보드, 포트, 프로세서) 를 설정합니다. 
3. **MotorControl.ino** 파일을 아두이노 툴에서 열고 `컴파일(Ctrl+R)`하고 `업로드(Ctrl+U)` 합니다.
4. 로봇젤리비의 양쪽 모터의 동작을 확인 합니다. 